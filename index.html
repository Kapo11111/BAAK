<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAAK</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        
        .shell {
            position: relative;
            top: 300px;
            left: 48%;
            width: 100px;
            height: 100px;
            background-color: white;
        }
        
        .ball {
            position: absolute;
            width: 93px;
            height: 93px;
            border-radius: 100%;
            background: url(./ball.png) no-repeat center center;
        }
        
        .wrap {
            display: none;
        }
    </style>
    <script src="./jquery.min.js"></script>
</head>

<body>
    <div class="wrap"></div>
    <div class="shell">
        <div class="ball"> </div>
    </div>
    <script>
        // 浏览器显示页面的宽高
        var width = document.documentElement.clientWidth;
        var height = document.documentElement.clientHeight;

        // 小球移动的范围
        var width_max = width - 93;
        var height_max = height - 93;
        console.log("width_max = " + width_max);
        console.log("height_max = " + height_max);

        // 获取小球
        var shell = document.querySelector(".shell");
        var wrap = document.querySelector('.wrap');
        var x = 0;
        var y = 0;
        // 鼠标移动事件
        shell.addEventListener('mousemove', function(e) {
            directionMouse();

            var direction = wrap.innerText;

            if (direction == '右侧进入' || direction == '下方进入') {
                shell.style.left = e.pageX - 90 + 'px';
                shell.style.top = e.pageY - 70 + 'px';
            } else if (direction == '左侧进入' || direction == '上方进入') {
                shell.style.left = e.pageX + 'px';
                shell.style.top = e.pageY - 30 + 'px';
            }

            if (e.pageY <= 90) {
                shell.style.top = 0;
            }

            if (e.pageY >= height_max + 60) {
                shell.style.top = height_max - 30 + 'px';
            }

            if (e.pageX <= 105) {
                shell.style.left = 0;
            }

            if (e.pageX >= width_max + 10) {
                shell.style.left = width_max + 'px';
            }

            // 小球反弹 向右
            if (e.pageX < 5) {

                var x = e.pageX + Math.ceil(Math.random() * 1000);
                $('.shell').animate({
                    left: x
                }, 500);
            }

            // 小球反弹 向左
            if (e.pageX > 1450) {
                var x = e.pageX - Math.ceil(Math.random(300) * 1000);
                $('.shell').animate({
                    left: x
                }, 500);

            }
            // 小球反弹 向下
            if (e.pageY < 5) {
                var y = e.pageY + Math.ceil(Math.random(300) * 500);
                $('.shell').animate({
                    top: y
                }, 500);
            }
            // 小球反弹 向上
            if (e.pageY > height_max) {
                var y = Math.ceil(Math.random(500) * 600);
                $('.shell').animate({
                    bottom: y
                }, 300);
            }

        });


        // 判断鼠标从那侧进入
        var directionMouse = function() {
            var ret;
            var shell = document.querySelector('.shell');
            var wrap = document.querySelector('.wrap');
            var hoverDir = function(e) {
                var w = shell.offsetWidth,
                    h = shell.offsetHeight,
                    x = (e.clientX - shell.offsetLeft - (w / 2)) * (w > h ? (h / w) : 1),
                    y = (e.clientY - shell.offsetTop - (h / 2)) * (h > w ? (w / h) : 1),
                    // 上(0) 右(1) 下(2) 左(3)
                    direction = Math.round((((Math.atan2(y, x) * (180 / Math.PI)) + 180) / 90) + 3) % 4,
                    eventType = e.type,
                    dirName = new Array('上方', '右侧', '下方', '左侧');
                if (e.type == 'mouseover' || e.type == 'mouseenter') {

                    wrap.innerHTML = dirName[direction] + '进入';

                } else {

                    wrap.innerHTML = dirName[direction] + '离开';

                }
            }
            if (window.addEventListener) {
                shell.addEventListener('mouseover', hoverDir, false);
                shell.addEventListener('mouseout', hoverDir, false);
            } else if (window.attachEvent) {
                shell.attachEvent('onmouseenter', hoverDir);
                shell.attachEvent('onmouseleave', hoverDir);
            }

        }
    </script>

</body>

</html>